#+title: Tasks
#+OPTIONS: toc:nil
#+LATEX_HEADER: \usepackage[margin=0.5in]{geometry}
#+LATEX_HEADER: \usepackage{pgfplots}


#+AUTHOR: Hee Hwang and Sudarshan Raghavan
#+EMAIL: {hhwang, sraghavan}@cs.umass.edu
# #+LATEX_CLASS_OPTIONS: [twocolumn]






* Baseline
ACL  : Citation Intent Classification\\
Hyper: HyperPartisan News Detection\\
RCT  : Randomized Controlled Trials

** Baseline
#+attr_latex: :align |c|c|c|c|c| 
   |------------+--------+-------+-------+---------|
   | Task       |  train |   dev |  test | Classes |
   |------------+--------+-------+-------+---------|
   | ACL        |   1688 |   114 |   139 |       6 |
   |------------+--------+-------+-------+---------|
   | Hyper      |    516 |    64 |    65 |       2 |
   |------------+--------+-------+-------+---------|
   | RCT-sample |    500 | 30212 | 30135 |       5 |
   |------------+--------+-------+-------+---------|
   | RCT-200k   | 180040 | 30212 | 30135 |       5 |
   |------------+--------+-------+-------+---------|




* Tables & Plots

# ** Augmentation by Size (Cumulative)
#    #+attr_latex: :align |c|c|c|c|c|
#    |-----------+-------+-------+-------+----------|
#    | Dataset # |   ACL | Hyper |   RCT | Interval |
#    |-----------+-------+-------+-------+----------|
#    |  Baseline | 62.70 | 90.24 | 73.60 |        - |
#    |-----------+-------+-------+-------+----------|
#    |         1 | 67.09 | 89.06 | 72.30 |     0-3% |
#    |-----------+-------+-------+-------+----------|
#    |         2 | 62.32 | 92.03 | 73.83 |     0-6% |
#    |-----------+-------+-------+-------+----------|
#    |         3 | 66.87 | 86.99 | 70.46 |     0-9% |
#    |-----------+-------+-------+-------+----------|
#    |         4 | 64.62 | 98.40 | 71.08 |    0-12% |
#    |-----------+-------+-------+-------+----------|
#    |         5 | 65.14 | 89.06 | 71.28 |    0-15% |
#    |-----------+-------+-------+-------+----------|
#    |         6 | 66.38 | 82.47 | 72.43 |    0-18% |
#    |-----------+-------+-------+-------+----------|
#    |         7 | 62.34 | 95.27 | 71.94 |    0-21% |
#    |-----------+-------+-------+-------+----------|
#    |         8 | 62.86 | 93.66 | 69.47 |    0-24% |
#    |-----------+-------+-------+-------+----------|
#    |         9 | 54.40 | 90.38 | 70.97 |    0-27% |
#    |-----------+-------+-------+-------+----------|
#    |        10 | 63.61 | 87.32 | 70.90 |    0-30% |
#    |-----------+-------+-------+-------+----------|



#    \begin{tikzpicture}[thick,scale=2.0]
#    \begin{axis}[
#        title={Augmentation by Size (Cumulative)},
#        xlabel={$Aug.\ Dataset \#$},
#        ylabel={$F1\ Score * 100$},
#        xmin=-1, xmax=11,
#        ymin=50, ymax=120,
#        xtick={1,2,3,4,5,6,7,8,9,10},
#        ytick={50,60,70,80,90,100},
#        ymajorgrids=true,
#        grid style=dashed,
#    ]
#    \addplot[ 
#        color=blue, 
#        mark=square, 
#        ]
#        coordinates {
#        (0,62.70)(1,67.09)(2,62.32)(3,66.87)(4,64.62)(5,65.14)(6,66.38)(7,62.34)(8,62.86)(9,54.40)(10,63.61)
#        };
#        \addlegendentry{ACL-ARC}

#     \addplot[
#         color=red,
#         mark=square,
#         ]
#         coordinates {
#         (0,90.24)(1,89.06)(2,92.03)(3,86.99)(4,98.40)(5,89.06)(6,82.47)(7,95.27)(8,93.66)(9,90.38)(10,87.32)
#         };
#         \addlegendentry{Hyperpartisan}

#    \addplot[
#        color=green,
#        mark=square,
#        ]
#        coordinates {
#        (0,73.60)(1,72.30)(2,73.83)(3,70.46)(4,71.08)(5,71.28)(6,72.43)(7,71.94)(8,69.47)(9,70.97)(10,70.90)
#        };
#        \addlegendentry{RCT-sample}


#    \end{axis}
#    \end{tikzpicture}

** Augmentation by Distance
*** Size Table
   #+attr_latex: :align |c|c|c|c|
   |--------------+-------------+-------------+----------------|
   | Max Distance | ACL         | Hyper       | RCT_{/sample/} |
   |--------------+-------------+-------------+----------------|
   |     Baseline | 1688 (100%) | 516 (100%)  |      500(100%) |
   |--------------+-------------+-------------+----------------|
   |           24 | 1746 (103%) | 551 (106%)  |      686(137%) |
   |--------------+-------------+-------------+----------------|
   |           26 | 1815 (107%) | 567 (109%)  |      831(166%) |
   |--------------+-------------+-------------+----------------|
   |           28 | 1981 (117%) | 606 (117%)  |     1065(213%) |
   |--------------+-------------+-------------+----------------|
   |           30 | 2253 (133%) | 656 (127%)  |     1484(296%) |
   |--------------+-------------+-------------+----------------|
   |           32 | 2842 (168%) | 742 (143%)  |     2105(421%) |
   |--------------+-------------+-------------+----------------|
   |           34 | 3848 (227%) | 911 (176%)  |     2952(590%) |
   |--------------+-------------+-------------+----------------|
   |           36 | 5819 (344%) | 1127 (218%) |     4196(839%) |
   |--------------+-------------+-------------+----------------|
*** Size Plot


\begin{tikzpicture}
\begin{axis}[
	x tick label style={
		/pgf/number format/1000 sep=},
	xlabel=L2 Distance,
	ylabel=Augmentation Size(\%),
	enlargelimits=0.05,
	ybar interval=0.7,
  legend style={at={(0,1)},anchor=north west}
]
\addplot[fill=blue] 
	coordinates {(24,103) (26,107) (28,117) (30,133) (32,168) (34,227) (36,344) (38,344)};
\addlegendentry{ACL-ARC}
\end{axis}
\end{tikzpicture}

\begin{tikzpicture}
\begin{axis}[
	x tick label style={
		/pgf/number format/1000 sep=},
	xlabel=L2 Distance,
	ylabel=Augmentation Size(\%),
	enlargelimits=0.05,
	ybar interval=0.7,
  legend style={at={(0,1)},anchor=north west}
]
\addplot[fill=red]
	coordinates {(24,106) (26,109) (28,117) (30,127) (32,143) (34,176) (36,218) (38,218)};
\addlegendentry{Hyperpartisan}
\end{axis}
\end{tikzpicture}


\begin{tikzpicture}
\begin{axis}[
	x tick label style={
		/pgf/number format/1000 sep=},
	xlabel=L2 Distance,
	ylabel=Augmentation Size(\%),
	enlargelimits=0.05,
	ybar interval=0.7,
  legend style={at={(0,1)},anchor=north west}
]
\addplot[fill=green]
	coordinates {(24,137) (26,166) (28,213) (30,296) (32,421) (34,590) (36,839) (38,839)};
\addlegendentry{RCT-sample}
\end{axis}
\end{tikzpicture}







*** F1 Table
   #+attr_latex: :align |c|c|c|c|
   |--------------+---------+---------+----------------|
   | Max Distance |     ACL |   Hyper | RCT_{/sample/} |
   |--------------+---------+---------+----------------|
   |     Baseline |   62.70 |   90.24 |        *73.60* |
   |--------------+---------+---------+----------------|
   |           24 | *73.45* | *93.66* |          70.06 |
   |--------------+---------+---------+----------------|
   |           26 |   71.71 |   81.98 |          69.19 |
   |--------------+---------+---------+----------------|
   |           28 |   66.17 |   92.03 |          64.50 |
   |--------------+---------+---------+----------------|
   |           30 |   65.34 |   81.32 |          60.57 |
   |--------------+---------+---------+----------------|
   |           32 |   61.64 |   88.85 |          58.77 |
   |--------------+---------+---------+----------------|
   |           34 |   59.56 |   83.75 |          53.47 |
   |--------------+---------+---------+----------------|
   |           36 |   59.22 |   88.70 |          53.27 |
   |--------------+---------+---------+----------------|

*** F1 Plot
   \begin{tikzpicture}[thick,scale=2.0]
   \begin{axis}[
       title={Augmentation by Maximum Distance},
       xlabel={$Max.\ Distance$},
       ylabel={$F1\ Score * 100$},
       xmin=20, xmax=38,
              ymin=50, ymax=120,
       xtick={24,26,28,30,32,34,36},
       ytick={50,60,70,80,90,100},
       ymajorgrids=true,
       grid style=dashed,
   ]
   \addplot[ 
       color=blue, 
       mark=square,
       ]
       coordinates {
       (22,62.70)(24,73.45)(26,71.71)(28,66.17)(30,65.34)(32,61.64)(34,59.56)(36,59.22)
       };
       \addlegendentry{ACL-ARC}

   \addplot[
       color=red,
       mark=square,
       ]
       coordinates {
       (22,90.24)(24,93.66)(26,81.98)(28,92.03)(30,81.32)(32,88.85)(34,83.75)(36,88.70)
       };
       \addlegendentry{Hyperpartisan}

   \addplot[
       color=green,
       mark=square,
       ]
       coordinates {
       (22,73.60)(24,70.06)(26,69.19)(28,64.50)(30,60.57)(32,58.77)(34,53.47)(36,53.27)
       };
       \addlegendentry{RCT-sample}

   \end{axis}
   \end{tikzpicture}


** Augmentation by Fixed Size
# *** Size Table
#    #+attr_latex: :align |c|c|c|c|
#    |--------------+-------------+-------------+------------|
#    | Max Distance | ACL         | Hyper       |        RCT |
#    |--------------+-------------+-------------+------------|
#    |     Baseline | 1688 (100%) | 516 (100%)  |  500(100%) |
#    |--------------+-------------+-------------+------------|
#    |           24 | 1746 (103%) | 551 (106%)  |  686(137%) |
#    |--------------+-------------+-------------+------------|
#    |           26 | 1815 (107%) | 567 (109%)  |  831(166%) |
#    |--------------+-------------+-------------+------------|
#    |           28 | 1981 (117%) | 606 (117%)  | 1065(213%) |
#    |--------------+-------------+-------------+------------|
#    |           30 | 2253 (133%) | 656 (127%)  | 1484(296%) |
#    |--------------+-------------+-------------+------------|
#    |           32 | 2842 (168%) | 742 (143%)  | 2105(421%) |
#    |--------------+-------------+-------------+------------|
#    |           34 | 3848 (227%) | 911 (176%)  | 2952(590%) |
#    |--------------+-------------+-------------+------------|
#    |           36 | 5819 (344%) | 1127 (218%) | 4196(839%) |
#    |--------------+-------------+-------------+------------|


*** F1 Table
   #+attr_latex: :align |c|c|c|c|c|
   |-----------+---------+---------+----------------+----------|
   | Dataset # |     ACL |   Hyper | RCT_{/sample/} | Interval |
   |-----------+---------+---------+----------------+----------|
   |  Baseline |   62.70 |   90.24 |        *73.60* |        - |
   |-----------+---------+---------+----------------+----------|
   |         1 |   66.24 |   90.38 |          73.26 |     0-3% |
   |-----------+---------+---------+----------------+----------|
   |         2 |   62.01 |   84.16 |          70.29 |     3-6% |
   |-----------+---------+---------+----------------+----------|
   |         3 |   60.48 |   86.99 |          71.89 |     6-9% |
   |-----------+---------+---------+----------------+----------|
   |         4 |   61.68 | *98.40* |          72.59 |    9-12% |
   |-----------+---------+---------+----------------+----------|
   |         5 | *69.66* |   95.22 |          71.69 |   12-15% |
   |-----------+---------+---------+----------------+----------|
   |         6 |   65.31 |   95.22 |          72.51 |   15-18% |
   |-----------+---------+---------+----------------+----------|
   |         7 |   65.00 |   93.50 |          71.66 |   18-21% |
   |-----------+---------+---------+----------------+----------|
   |         8 |   66.22 |   77.82 |          71.99 |   21-24% |
   |-----------+---------+---------+----------------+----------|
   |         9 |   58.84 |   91.93 |          70.14 |   24-27% |
   |-----------+---------+---------+----------------+----------|
   |        10 |   57.61 |   86.78 |          70.44 |   27-30% |
   |-----------+---------+---------+----------------+----------|

*** F1 Plot
   \begin{tikzpicture}[thick,scale=2.0]
   \begin{axis}[
       title={Augmentation by Size (Non-cumulative)},
       xlabel={$Aug.\ Dataset$},
       ylabel={$F1\ Score * 100$},
       xmin=-1, xmax=11,
       ymin=50, ymax=120,
       xtick={1,2,3,4,5,6,7,8,9,10},
       ytick={50,60,70,80,90,100},
       ymajorgrids=true,
       grid style=dashed,
   ]

   \addplot[ 
       color=blue, 
       mark=square, 
       ]
       coordinates {
       (0,62.70)(1,66.24)(2,62.01)(3,60.48)(4,61.68)(5,69.66)(6,65.31)(7,65.00)(8,66.22)(9,58.84)(10,57.61)
       };
       \addlegendentry{ACL-ARC}

    \addplot[
        color=red,
        mark=square,
        ]
        coordinates {
        (0,90.24)(1,90.38)(2,84.16)(3,86.99)(4,98.40)(5,95.22)(6,95.22)(7,93.50)(8,77.82)(9,91.93)(10,86.78)
        };
        \addlegendentry{Hyperpartisan}

    \addplot[
        color=green,
        mark=square,
        ]
        coordinates {
        (0,73.60)(1,73.26)(2,70.29)(3,71.89)(4,72.59)(5,71.69)(6,72.51)(7,71.66)(8,71.99)(9,70.14)(10,70.44)
        };
        \addlegendentry{RCT-sample}

   \end{axis}
   \end{tikzpicture}



* Baseline models: 
  - An off-the-shelf RoBERTa model that has been finetuned to perform classification for each of the downstream tasks

* Augmentation Model
  [[./png/da.png]]


* Algorithm
  #+BEGIN_SRC
1. Extract failed test examples from the baseline model
2. Retrieve passages/sentences from Common Crawl 
3. Apply augmentation strategy (i)-(iii)
4. Augment all the labelled CC data to the training data
5. Retrain RoBERTa on the augmented training set 
  #+END_SRC

* Augmentation Strategies 
  - Strategy (i)\\
    Use baseline model (Teacher) to perform unsupervised labelling on retrieved CC data
  - Strategy (ii)\\
    Using a task specific binary classifier, 
    filter out retrieved CC data that is "out-domain"\\
    Use baseline model (Teacher) to perform unsupervised labelling on the filtered "in-domain" CC data
  - Strategy (iii)\\
    Using a task specific binary classifier, 
    filter out retrieved CC data that is "out-domain"\\
    Use ground truth labels of failed test examples and assign labels to the filtered "in-domain" CC data




  # ** Augmentation by size
  #    |------+-------+---------+-------+-------+-------+-------|
  #    | Task |   +0% |    +17% |  +35% |  +53% |  +71% |  +88% |
  #    |------+-------+---------+-------+-------+-------+-------|
  #    | ACL  | 62.70 | *65.59* | 59.92 | 57.65 | 60.78 | 55.70 |
  #    |------+-------+---------+-------+-------+-------+-------|
