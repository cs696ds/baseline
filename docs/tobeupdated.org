#+title: Tasks
#+OPTIONS: toc:nil
#+LATEX_HEADER: \usepackage[margin=0.5in]{geometry}
#+LATEX_HEADER: \usepackage{pgfplots}


#+AUTHOR: Hee Hwang and Sudarshan Raghavan
#+EMAIL: {hhwang, sraghavan}@cs.umass.edu
# #+LATEX_CLASS_OPTIONS: [twocolumn]






* Baseline
ACL  : Citation Intent Classification\\
Hyper: HyperPartisan News Detection\\
RCT  : Randomized Controlled Trials

** Baseline
#+attr_latex: :align |c|c|c|c|c| 
   |------------+--------+-------+-------+---------|
   | Task       |  train |   dev |  test | Classes |
   |------------+--------+-------+-------+---------|
   | ACL        |   1688 |   114 |   139 |       6 |
   |------------+--------+-------+-------+---------|
   | Hyper      |    516 |    64 |    65 |       2 |
   |------------+--------+-------+-------+---------|
   | RCT-sample |    500 | 30212 | 30135 |       5 |
   |------------+--------+-------+-------+---------|
   | RCT-200k   | 180040 | 30212 | 30135 |       5 |
   |------------+--------+-------+-------+---------|




* Tables & Plots

# ** Augmentation by Size (Cumulative)
#    #+attr_latex: :align |c|c|c|c|c|
#    |-----------+-------+-------+-------+----------|
#    | Dataset # |   ACL | Hyper |   RCT | Interval |
#    |-----------+-------+-------+-------+----------|
#    |  Baseline | 62.70 | 90.24 | 73.60 |        - |
#    |-----------+-------+-------+-------+----------|
#    |         1 | 67.09 | 89.06 | 72.30 |     0-3% |
#    |-----------+-------+-------+-------+----------|
#    |         2 | 62.32 | 92.03 | 73.83 |     0-6% |
#    |-----------+-------+-------+-------+----------|
#    |         3 | 66.87 | 86.99 | 70.46 |     0-9% |
#    |-----------+-------+-------+-------+----------|
#    |         4 | 64.62 | 98.40 | 71.08 |    0-12% |
#    |-----------+-------+-------+-------+----------|
#    |         5 | 65.14 | 89.06 | 71.28 |    0-15% |
#    |-----------+-------+-------+-------+----------|
#    |         6 | 66.38 | 82.47 | 72.43 |    0-18% |
#    |-----------+-------+-------+-------+----------|
#    |         7 | 62.34 | 95.27 | 71.94 |    0-21% |
#    |-----------+-------+-------+-------+----------|
#    |         8 | 62.86 | 93.66 | 69.47 |    0-24% |
#    |-----------+-------+-------+-------+----------|
#    |         9 | 54.40 | 90.38 | 70.97 |    0-27% |
#    |-----------+-------+-------+-------+----------|
#    |        10 | 63.61 | 87.32 | 70.90 |    0-30% |
#    |-----------+-------+-------+-------+----------|



#    \begin{tikzpicture}[thick,scale=2.0]
#    \begin{axis}[
#        title={Augmentation by Size (Cumulative)},
#        xlabel={$Aug.\ Dataset \#$},
#        ylabel={$F1\ Score * 100$},
#        xmin=-1, xmax=11,
#        ymin=50, ymax=120,
#        xtick={1,2,3,4,5,6,7,8,9,10},
#        ytick={50,60,70,80,90,100},
#        ymajorgrids=true,
#        grid style=dashed,
#    ]
#    \addplot[ 
#        color=blue, 
#        mark=square, 
#        ]
#        coordinates {
#        (0,62.70)(1,67.09)(2,62.32)(3,66.87)(4,64.62)(5,65.14)(6,66.38)(7,62.34)(8,62.86)(9,54.40)(10,63.61)
#        };
#        \addlegendentry{ACL-ARC}

#     \addplot[
#         color=red,
#         mark=square,
#         ]
#         coordinates {
#         (0,90.24)(1,89.06)(2,92.03)(3,86.99)(4,98.40)(5,89.06)(6,82.47)(7,95.27)(8,93.66)(9,90.38)(10,87.32)
#         };
#         \addlegendentry{Hyperpartisan}

#    \addplot[
#        color=green,
#        mark=square,
#        ]
#        coordinates {
#        (0,73.60)(1,72.30)(2,73.83)(3,70.46)(4,71.08)(5,71.28)(6,72.43)(7,71.94)(8,69.47)(9,70.97)(10,70.90)
#        };
#        \addlegendentry{RCT-sample}


#    \end{axis}
#    \end{tikzpicture}

** Augmentation by Distance
*** Size Table
   #+attr_latex: :align |c|c|c|c|
   |--------------+-------------+-------------+----------------|
   | Max Distance | ACL         | Hyper       | RCT_{/sample/} |
   |--------------+-------------+-------------+----------------|
   |     Baseline | 1688 (100%) | 516 (100%)  |      500(100%) |
   |--------------+-------------+-------------+----------------|
   |           24 | 1746 (103%) | 551 (106%)  |      686(137%) |
   |--------------+-------------+-------------+----------------|
   |           26 | 1815 (107%) | 567 (109%)  |      831(166%) |
   |--------------+-------------+-------------+----------------|
   |           28 | 1981 (117%) | 606 (117%)  |     1065(213%) |
   |--------------+-------------+-------------+----------------|
   |           30 | 2253 (133%) | 656 (127%)  |     1484(296%) |
   |--------------+-------------+-------------+----------------|
   |           32 | 2842 (168%) | 742 (143%)  |     2105(421%) |
   |--------------+-------------+-------------+----------------|
   |           34 | 3848 (227%) | 911 (176%)  |     2952(590%) |
   |--------------+-------------+-------------+----------------|
   |           36 | 5819 (344%) | 1127 (218%) |     4196(839%) |
   |--------------+-------------+-------------+----------------|
*** Size Plot


\begin{tikzpicture}
\begin{axis}[
	x tick label style={
		/pgf/number format/1000 sep=},
	xlabel=L2 Distance,
	ylabel=Augmentation Size(\%),
	enlargelimits=0.05,
	ybar interval=0.7,
  legend style={at={(0,1)},anchor=north west}
]
\addplot[fill=blue] 
	coordinates {(24,103) (26,107) (28,117) (30,133) (32,168) (34,227) (36,344) (38,344)};
\addlegendentry{ACL-ARC}
\end{axis}
\end{tikzpicture}

\begin{tikzpicture}
\begin{axis}[
	x tick label style={
		/pgf/number format/1000 sep=},
	xlabel=L2 Distance,
	ylabel=Augmentation Size(\%),
	enlargelimits=0.05,
	ybar interval=0.7,
  legend style={at={(0,1)},anchor=north west}
]
\addplot[fill=red]
	coordinates {(24,106) (26,109) (28,117) (30,127) (32,143) (34,176) (36,218) (38,218)};
\addlegendentry{Hyperpartisan}
\end{axis}
\end{tikzpicture}


\begin{tikzpicture}
\begin{axis}[
	x tick label style={
		/pgf/number format/1000 sep=},
	xlabel=L2 Distance,
	ylabel=Augmentation Size(\%),
	enlargelimits=0.05,
	ybar interval=0.7,
  legend style={at={(0,1)},anchor=north west}
]
\addplot[fill=green]
	coordinates {(24,137) (26,166) (28,213) (30,296) (32,421) (34,590) (36,839) (38,839)};
\addlegendentry{RCT-sample}
\end{axis}
\end{tikzpicture}







*** F1 Table
   #+attr_latex: :align |c|c|c|c|
   |--------------+-----------------+-----------------+-----------------|
   | Max Distance | ACL             | Hyper           | RCT_{/sample/}  |
   |--------------+-----------------+-----------------+-----------------|
   |     Baseline | 62.70           | 90.24           | 73.60           |
   |--------------+-----------------+-----------------+-----------------|
   |           24 | 65.77(\pm 7.40) | 92.68(\pm 3.29) | 69.33(\pm 0.73) |
   |--------------+-----------------+-----------------+-----------------|
   |           26 | 66.79(\pm 3.07) | 90.63(\pm 5.92) | 67.31(\pm 1.96) |
   |--------------+-----------------+-----------------+-----------------|
   |           28 | 63.93(\pm 3.67) | 92.66(\pm 4.39) | 63.91(\pm 1.25) |
   |--------------+-----------------+-----------------+-----------------|
   |           30 | 62.57(\pm 2.70) | 89.60(\pm 5.04) | 60.43(\pm 0.64) |
   |--------------+-----------------+-----------------+-----------------|
   |           32 | 64.83(\pm 5.28) | 90.15(\pm 5.22) | 57.23(\pm 1.27) |
   |--------------+-----------------+-----------------+-----------------|
   |           34 | 57.06(\pm 3.05) | 88.36(\pm 3.26) | 54.36(\pm 1.31) |
   |--------------+-----------------+-----------------+-----------------|
   |           36 | 56.20(\pm 4.21) | 89.49(\pm 2.40) | 52.76(\pm 0.85) |
   |--------------+-----------------+-----------------+-----------------|

*** F1 Plot
   \begin{tikzpicture}[thick,scale=2.0]
   \begin{axis}[
       title={Augmentation by Maximum Distance},
       xlabel={Max. Distance},
       ylabel={F1 Score $\times$ 100},
       xmin=20, xmax=38,
              ymin=50, ymax=120,
       xtick={24,26,28,30,32,34,36},
       ytick={50,60,70,80,90,100},
       ymajorgrids=true,
       grid style=dashed,       
   ]
   \addplot+ [error bars/.cd, y dir=both, y explicit,]
       coordinates {
       (22,62.70)
       (24,65.77) +- (0,7.40)
       (26,66.79) +- (0,3.07)
       (28,63.93) +- (0,3.67) 
       (30,62.57) +- (0,2.70)
       (32,64.83) +- (0,5.28)
       (34,57.06) +- (0,3.05)
       (36,56.20) +- (0,4.21)
       };
       \addlegendentry{ACL-ARC}
   \addplot+ [error bars/.cd, y dir=both, y explicit,]
       coordinates {
       (22,90.24)
       (24,92.68) +- (0,3.29)
       (26,90.63) +- (0,5.92)
       (28,92.66) +- (0,4.39)
       (30,89.60) +- (0,5.04)
       (32,90.15) +- (0,5.22)
       (34,88.36) +- (0,3.26)
       (36,89.49) +- (0,2.40)
       };
       \addlegendentry{Hyperpartisan}
   \addplot+ [error bars/.cd, y dir=both, y explicit,]
       coordinates {
       (22,73.60)
       (24,69.33) +- (0,0.73)
       (26,67.31) +- (0,1.96)
       (28,63.91) +- (0,1.25)
       (30,60.43) +- (0,0.64)
       (32,57.23) +- (0,1.27)
       (34,54.36) +- (0,1.31)
       (36,52.76) +- (0,0.85)
       };
       \addlegendentry{RCT-sample}
   \end{axis}
   \end{tikzpicture}


** Augmentation by Fixed Size
# *** Size Table
#    #+attr_latex: :align |c|c|c|c|
#    |--------------+-------------+-------------+------------|
#    | Max Distance | ACL         | Hyper       |        RCT |
#    |--------------+-------------+-------------+------------|
#    |     Baseline | 1688 (100%) | 516 (100%)  |  500(100%) |
#    |--------------+-------------+-------------+------------|
#    |           24 | 1746 (103%) | 551 (106%)  |  686(137%) |
#    |--------------+-------------+-------------+------------|
#    |           26 | 1815 (107%) | 567 (109%)  |  831(166%) |
#    |--------------+-------------+-------------+------------|
#    |           28 | 1981 (117%) | 606 (117%)  | 1065(213%) |
#    |--------------+-------------+-------------+------------|
#    |           30 | 2253 (133%) | 656 (127%)  | 1484(296%) |
#    |--------------+-------------+-------------+------------|
#    |           32 | 2842 (168%) | 742 (143%)  | 2105(421%) |
#    |--------------+-------------+-------------+------------|
#    |           34 | 3848 (227%) | 911 (176%)  | 2952(590%) |
#    |--------------+-------------+-------------+------------|
#    |           36 | 5819 (344%) | 1127 (218%) | 4196(839%) |
#    |--------------+-------------+-------------+------------|


*** F1 Table
   #+attr_latex: :align |c|c|c|c|c|
   |----------+-----------------+-----------------+-----------------|
   | Aug Data | ACL             | Hyper           | RCT_{/sample/}  |
   |----------+-----------------+-----------------+-----------------|
   | Baseline | 62.70           | 90.24           | 73.60           |
   |----------+-----------------+-----------------+-----------------|
   |        1 | 65.28(\pm 5.05) | 89.12(\pm 7.31) | 71.65(\pm 1.97) |
   |----------+-----------------+-----------------+-----------------|
   |        2 | 64.71(\pm 3.61) | 90.74(\pm 3.94) | 71.20(\pm 0.99) |
   |----------+-----------------+-----------------+-----------------|
   |        3 | 66.73(\pm 3.72) | 90.94(\pm 4.54) | 72.04(\pm 0.20) |
   |----------+-----------------+-----------------+-----------------|
   |        4 | 65.26(\pm 3.20) | 92.64(\pm 4.59) | 72.27(\pm 1.31) |
   |----------+-----------------+-----------------+-----------------|
   |        5 | 65.80(\pm 3.10) | 93.28(\pm 2.62) | 71.68(\pm 0.71) |
   |----------+-----------------+-----------------+-----------------|
   |        6 | 65.39(\pm 4.23) | 89.11(\pm 5.22) | 71.96(\pm 0.87) |
   |----------+-----------------+-----------------+-----------------|
   |        7 | 63.25(\pm 2.51) | 89.90(\pm 4.97) | 71.78(\pm 1.07) |
   |----------+-----------------+-----------------+-----------------|
   |        8 | 65.81(\pm 2.13) | 87.84(\pm 6.20) | 71.75(\pm 0.66) |
   |----------+-----------------+-----------------+-----------------|
   |        9 | 66.85(\pm 6.14) | 91.23(\pm 2.50) | 71.77(\pm 0.97) |
   |----------+-----------------+-----------------+-----------------|
   |       10 | 62.68(\pm 3.29) | 91.54(\pm 4.01) | 71.32(\pm 0.54) |
   |----------+-----------------+-----------------+-----------------|

*** F1 Plot
   \begin{tikzpicture}[thick,scale=2.0]
   \begin{axis}[
       title={Augmentation by Size (Non-cumulative)},
       xlabel={Aug. Dataset},
       ylabel={F1 Score $\times$ 100},
       xmin=-1, xmax=11,
       ymin=50, ymax=120,
       xtick={1,2,3,4,5,6,7,8,9,10},
       ytick={50,60,70,80,90,100},
       ymajorgrids=true,
       grid style=dashed,
   ]

   \addplot+ [error bars/.cd, y dir=both, y explicit,]
       coordinates {
       (0,62.70)
       (1,65.28)  +- (0,5.05)
       (2,64.71)  +- (0,3.61)
       (3,66.73)  +- (0,3.72)
       (4,65.26)  +- (0,3.20)
       (5,65.80)  +- (0,3.10)
       (6,65.39)  +- (0,4.23)
       (7,63.25)  +- (0,2.51)
       (8,65.81)  +- (0,2.13)
       (9,66.85)  +- (0,6.14)
       (10,62.68) +- (0,3.29)
       };
       \addlegendentry{ACL-ARC}

   \addplot+ [error bars/.cd, y dir=both, y explicit,]
        coordinates {
        (0,90.24)
        (1,89.12)  +- (0,7.31)
        (2,90.74)  +- (0,3.94)
        (3,90.94)  +- (0,4.54)
        (4,92.64)  +- (0,4.59)
        (5,93.28)  +- (0,2.62)
        (6,89.11)  +- (0,5.22)
        (7,89.90)  +- (0,4.97)
        (8,87.84)  +- (0,6.20)
        (9,91.23)  +- (0,2.50)
        (10,91.54) +- (0,4.01)
        };
        \addlegendentry{Hyperpartisan}

   \addplot+ [error bars/.cd, y dir=both, y explicit,]
        coordinates {
        (0,73.60)   
        (1,71.65)  +- (0,1.97)
        (2,71.20)  +- (0,0.99)
        (3,72.04)  +- (0,0.20)
        (4,72.27)  +- (0,1.31) 
        (5,71.68)  +- (0,0.71)
        (6,71.96)  +- (0,0.87)
        (7,71.78)  +- (0,1.07)
        (8,71.75)  +- (0,0.66)
        (9,71.77)  +- (0,0.97)
        (10,71.32) +- (0,0.54)
        };
        \addlegendentry{RCT-sample}

   \end{axis}
   \end{tikzpicture}



* Baseline models: 
  - An off-the-shelf RoBERTa model that has been finetuned to perform classification for each of the downstream tasks

* Augmentation Model
  [[./png/da.png]]


* Algorithm
  #+BEGIN_SRC
1. Extract failed test examples from the baseline model
2. Retrieve passages/sentences from Common Crawl 
3. Apply augmentation strategy (i)-(iii)
4. Augment all the labelled CC data to the training data
5. Retrain RoBERTa on the augmented training set 
  #+END_SRC

* Augmentation Strategies 
  - Strategy (i)\\
    Use baseline model (Teacher) to perform unsupervised labelling on retrieved CC data
  - Strategy (ii)\\
    Using a task specific binary classifier, 
    filter out retrieved CC data that is "out-domain"\\
    Use baseline model (Teacher) to perform unsupervised labelling on the filtered "in-domain" CC data
  - Strategy (iii)\\
    Using a task specific binary classifier, 
    filter out retrieved CC data that is "out-domain"\\
    Use ground truth labels of failed test examples and assign labels to the filtered "in-domain" CC data




  # ** Augmentation by size
  #    |------+-------+---------+-------+-------+-------+-------|
  #    | Task |   +0% |    +17% |  +35% |  +53% |  +71% |  +88% |
  #    |------+-------+---------+-------+-------+-------+-------|
  #    | ACL  | 62.70 | *65.59* | 59.92 | 57.65 | 60.78 | 55.70 |
  #    |------+-------+---------+-------+-------+-------+-------|
